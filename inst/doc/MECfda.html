<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Ji, Heyang" />
<meta name="author" content="Beyaztas, Ufuk" />
<meta name="author" content="Escobar, Nicolas" />
<meta name="author" content="Luan, Yuanyuan" />
<meta name="author" content="Chen, Xiwei" />
<meta name="author" content="Zhang, Mengli" />
<meta name="author" content="Zoh, Roger" />
<meta name="author" content="Xue, Lan" />
<meta name="author" content="Tekwe, Carmen" />


<title>MECfda: An R package for bias correction due to measurement error in functional and scalar covariates in scalar-on-function regression models</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>

<style type="text/css">
p.abstract{
text-align: center;
font-weight: bold;
}
div.abstract{
margin: auto;
width: 90%;
}
</style>


<style type="text/css">

div.csl-bib-body { }
div.csl-entry {
clear: both;
}
.hanging div.csl-entry {
margin-left:2em;
text-indent:-2em;
}
div.csl-left-margin {
min-width:2em;
float:left;
}
div.csl-right-inline {
margin-left:2em;
padding-left:1em;
}
div.csl-indent {
margin-left: 2em;
}
</style>

<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">MECfda: An R package for bias correction
due to measurement error in functional and scalar covariates in
scalar-on-function regression models</h1>
<h4 class="author">Ji, Heyang</h4>
<h4 class="author">Beyaztas, Ufuk</h4>
<h4 class="author">Escobar, Nicolas</h4>
<h4 class="author">Luan, Yuanyuan</h4>
<h4 class="author">Chen, Xiwei</h4>
<h4 class="author">Zhang, Mengli</h4>
<h4 class="author">Zoh, Roger</h4>
<h4 class="author">Xue, Lan</h4>
<h4 class="author">Tekwe, Carmen</h4>
<div class="abstract">
<p class="abstract">Abstract</p>
Functional data analysis is a statistical approach used to analyze data
that appear as functions or images. Functional data analysis methods can
be used to analyze device-based measures such as physical activity and
sleep. Although device-based measures are more objective than
self-reported measures of physical activity patterns or sleep activity,
device-based measures can still be prone to measurement error. When
assessing associations between scalar-valued outcomes and device-based
measures, scalar-on-function regression models that correct for
measurement error can be applied. We develop the <strong>MECfda</strong>
package for several scalar-on-function regression models including
multi-level generalized scalar-on-function regression models and
functional quantile linear regression models. The developed package
implements several bias-correction methods that account for the presence
of multiple functional and scalar covariates prone to measurement error
in various scalar-on-function regression settings.
</div>



<!-- output: -->
<!--   pdf_document: default -->
<!--   word_document: default -->
<!-- output: pdf_document -->
<!-- output: word_document -->
<!-- output: rmarkdown::html_vignette -->
<p><!-- - name: Ji, Heyang^[Indiana University, jihx1015@outlook.com] -->
<!-- - name: Beyaztas, Ufuk --> <!-- - name: Escobar, Nicolas -->
<!-- - name: Luan, Yuanyuan^[Indiana University] -->
<!-- - name: Chen, Xiwei^[Indiana University] -->
<!-- - name: Zoh, Roger^[Indiana University] -->
<!-- - name: Xue, Lan^[Oregan State University] -->
<!-- - name: Tekwe, Carmen^[Indiana University] -->
<!-- output: html_document --> <!-- output: latex_fragment --></p>
<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>Functional data analysis (FDA) is an essential statistical approach
for handling high-dimensional data that appear in the form of functions
or images <span class="citation">[1–3]</span>. In many applications,
data are collected continuously or at frequent time intervals, resulting
in complex functions over time. When the objective is to study the
relationship between a scalar response and both functional and scalar
covariates, scalar-on-function regression models become a natural
choice.</p>
<p>Although self-reported measures (e.g., dietary intake) are known to
suffer from measurement error <span class="citation">[4]</span>, recent
studies have demonstrated that even device-based measurements (such as
those from wearable devices) can be error prone <span class="citation">[5, 6]</span>. Failing to correct for measurement error
in either scalar or function-valued covariates may lead to biased
parameter estimates.</p>
<p>The goal of the <strong>MECfda</strong> package is to provide
solutions for a range of scalar-on-function regression models—including
multi-level generalized scalar-on-function regression models and
functional quantile regression models—while incorporating several
bias-correction methods for measurement error in scalar-on-function
regression problem.</p>
<p>This package is developed in <a href="https://www.R-project.org/">R</a>.</p>
<!-- 
Functional data analysis is commonly use
to analyze high-dimensional data that appear as functions or images 
[@wang2016functional] [@ramsay2002applied] [@ramsay1991some].
Functional data analysis can be used to analyzed data collected 
continuously or frequently over a given time period that appear as 
complex high dimensional functions of time. 
When assessing how both functional and scalar-valued covariates 
influence scalar-valued outcomes, 
scalar-on-function regression models may be used. 
Self-reported measures, such as dietary intake,
are well known to be prone to measurement error[@carroll2006measurement],
and recent studies have indicated that even the relatively more objective data 
obtained from wearable devices is prone to measurement error
[@crainiceanu2009generalized] [@tekwe2019instrumental]. 
It has been demonstrated that similar to scalar-valued covariates prone 
to measurement error, the failure to correct for biases due to measurement error 
associated with functional data also leads to biased estimates

We develop an 
[R](https://www.R-project.org/)
package **MECfda**
for solving scalar-on-function regression models including
multi-level generalized scalar-on-function regression models 
and functional quantile linear regression models
measurement error corrections using various bias reduction techniques 
in these models.

-->
<!-- 
Functional data analysis is a commonly used
technique when the data are very high dimensional. 
We treat some variables in the dataset as function (of time, usually) and utilize the 
infinite dimensionality of function space to provide enough degree of freedom in statistical model 
so that we can capture the complicated distribution pattern due to the high dimensionality of the data. 
Scalar-on-function linear regression model is an important model of in functional data analysis,
in which the response variable is scalar-valued and one or multiple function-valued covariates are included. 

One of the scenario where functional data analysis is most commonly used is analysis of physical activity data collected by wearable devices. 
An important problem in physical activity data collected by wearable devices is that such data usually have measurement error, which lead to bias in parameter estimation.

Our aim is to develop an [\textsf{R}](https://www.R-project.org/) package that can solve all kinds of 
scalar-on-function linear regression models and 
include some developed estimation methods that correct the bias
due to measurement error in scalar-on-function linear regression models. 
-->
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(MECfda)</span></code></pre></div>
</div>
<div id="scalar-on-function-linear-regression-models" class="section level1">
<h1>Scalar-on-Function Linear Regression Models</h1>
<!-- The generic form  -->
<p>The general form of the scalar-on-function regression model is given
by <span class="math display">\[T(F_{Y_i|X_i,Z_i}) =  \sum_{l=1}^{L}
\int_{\Omega_l} \beta_l(t) X_{li}(t) dt + (1,Z_i^T)\gamma\]</span>
where</p>
<ul>
<li><span class="math inline">\(Y_i\)</span> is the scalar response
variable;</li>
<li><span class="math inline">\(X_{li}(t)\)</span> denotes the <span class="math inline">\(l\)</span>th function-valued covariate defined on
the domain <span class="math inline">\(\Omega_l\)</span>;</li>
<li><span class="math inline">\(\beta_l(t)\)</span> is the corresponding
function-valued regression coefficient, and both <span class="math inline">\(\beta_l\)</span> and <span class="math inline">\(X_{li}\)</span> belong to <span class="math inline">\(L^2(\Omega_l)\)</span>;</li>
<li><span class="math inline">\(Z_i = (Z_{1i}, \dots, Z_{qi})^T\)</span>
represents the scalar covariates;</li>
<li><span class="math inline">\(\gamma = (\gamma_0, \gamma_1, \dots,
\gamma_q)^T\)</span> is the parameter vector for the scalar
covariates;</li>
<li><span class="math inline">\(F_{Y_i\mid X_i,Z_i}\)</span> is the
cumulative distribution function of <span class="math inline">\(Y_i\)</span> conditional on <span class="math inline">\(X_i\)</span> and <span class="math inline">\(Z_i\)</span>;</li>
<li><span class="math inline">\(T(\cdot)\)</span> is a statistical
functional.</li>
</ul>
<p>A statistical functional is defined as a mapping from a probability
distribution to a real number. Statistical functionals represent
quantiﬁable properties of probability distributions, (e.g., an
expectation, a variance or a quantile).</p>
<p>Two common model types supported in this package are:</p>
<ol style="list-style-type: decimal">
<li><p><strong>Multi-level Generalized Scalar-on-Function
Regression:</strong><br />
This model is formulated as <span class="math display">\[
T\bigl(F_{Y_i\mid X_i,Z_i}\bigr) = g\Bigl\{E(Y_i\mid X_i,Z_i)\Bigr\} =
g\left\{\int_\mathbb{R}ydF_{Y_i|X_i,Z_i}(y)\right\},
\]</span> where <span class="math inline">\(g(\cdot)\)</span> is a
strictly monotonic link function analogous to that used in generalized
linear models.</p></li>
<li><p><strong>Scalar-on-Function Quantile Regression:</strong><br />
This model is expressed as <span class="math display">\[
T\bigl(F_{Y_i\mid X_i,Z_i}\bigr) = Q_{Y_i\mid X_i,Z_i}(\tau) =
F_{Y_i\mid X_i,Z_i}^{-1}(\tau),
\]</span> where <span class="math inline">\(\tau \in (0,1)\)</span>
denotes the quantile of interest.</p></li>
</ol>
<div id="representation-of-functional-data" class="section level2">
<h2>Representation of Functional Data</h2>
<p>Function-valued variables (functional variables) are typically
recorded as measurements at specific time points, resulting in an <span class="math inline">\(n \times m\)</span> data matrix <span class="math inline">\((x_{ij})\)</span>, where each row corresponds to
an observation (subject) and each column to a measurement time.</p>
</div>
<div id="functional-data" class="section level2">
<h2>Functional Data</h2>
<p>Function-valued variables (functional variables) are typically
recorded as the measurements of the values of the functions at specific
(time) points in the domain. The data of a function-valued variable are
often presented in the form of a matrix, <span class="math inline">\((x_{ij})_{n\times m}\)</span>, where <span class="math inline">\(x_{ij} = f_i(t_j)\)</span>, represents the value
of <span class="math inline">\(f_i(t_j)\)</span>, each row corresponds
to an observation (subject) and each column to a measurement time.</p>
<div id="s4-class-functional_variable" class="section level3">
<h3>S4 Class <code>functional_variable</code></h3>
<p>In the <strong>MECfda</strong> package, the s4 class
<code>functional_variable</code> represents function-valued data stored
in matrix form. The main slots include:</p>
<ul>
<li><strong><code>X</code></strong>: The data matrix <span class="math inline">\((x_{ij})\)</span>;<!-- $(x_{ij})_{n\times m}$ --></li>
<li><strong><code>t_0</code></strong> and
<strong><code>period</code></strong>: The left endpoint and length of
the function’s domain, respectively (The class only support the domain
in the format of interval);</li>
<li><strong><code>t_points</code></strong>: A vector of the time points
at which the measurements are recorded.</li>
</ul>
<p>A dedicated method, <code>dim</code>, returns the number of subjects
and the number of measurement points for a
<code>functional_variable</code> object.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>fv <span class="ot">=</span> <span class="fu">functional_variable</span>(</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>  <span class="at">X =</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(<span class="dv">10</span><span class="sc">*</span><span class="dv">24</span>),<span class="dv">10</span>,<span class="dv">24</span>),</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>  <span class="at">t_0 =</span> <span class="dv">0</span>,</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>  <span class="at">period =</span> <span class="dv">1</span>,</span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a>  <span class="at">t_points =</span> (<span class="dv">0</span><span class="sc">:</span><span class="dv">9</span>)<span class="sc">/</span><span class="dv">10</span></span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a>)</span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a><span class="fu">dim</span>(fv)</span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a><span class="co">#&gt;     subject time_points </span></span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a><span class="co">#&gt;          10          24</span></span></code></pre></div>
</div>
</div>
<div id="basis-expansion" class="section level2">
<h2>Basis Expansion</h2>
<p>Let <span class="math inline">\(\{\rho_{k}\}_{k=1}^\infty\)</span> be
a complete basis for <span class="math inline">\(L^2(\Omega)\)</span>.
For an arbitrary function <span class="math inline">\(\beta(t) \in
L^2(\Omega)\)</span>, there exists a sequence of (real) number <span class="math inline">\(\{c_k\}\)</span> such that <span class="math display">\[
\beta(t) = \sum_{k=1}^\infty c_k \, \rho_k(t).
\]</span></p>
<p>For the function-valued variable <span class="math inline">\(X_i(t)\)</span>, we have <span class="math display">\[
\int_\Omega \beta(t) X_i(t) \, dt = \int_\Omega X_i(t) \sum_{k=1}^\infty
c_{k}\rho_{k}(t) dt = \sum_{k=1}^\infty c_k \int_\Omega \rho_k(t) X_i(t)
\, dt.
\]</span></p>
<p>In practice, for <span class="math inline">\(\int_\Omega\beta(t)
X_i(t) dt\)</span> in statistical models, we truncate the infinite
series to <span class="math inline">\(p\)</span> terms (<span class="math inline">\(p&lt;\infty\)</span>), using <span class="math inline">\(c_{k} \int_\Omega X_i(t) \rho_{k}(t) dt\)</span>
to approximate <span class="math inline">\(\int_\Omega\beta(t) X_i(t)
dt\)</span> so that the problem reduces to estimating a finite number of
parameters <span class="math inline">\(c_1, \dots, c_p\)</span>, and
treating <span class="math inline">\(\int_\Omega \rho_k(t) X_i(t) \,
dt\)</span> as new covariates. The number of basis, <span class="math inline">\(p\)</span>, can be related to the sample size,
<span class="math inline">\(n\)</span>, and the <span class="math inline">\(p\)</span> is in a form of <span class="math inline">\(p(n)\)</span>.</p>
<p>In practice, we may not necessarily use the truncated complete basis
of <span class="math inline">\(L^2\)</span> function space. Instead, we
can just use a finite sequence of linearly independent functions as the
basis function. Common choices for the basis include the Fourier basis,
b-spline basis, and eigenfunction basis.</p>
<p>In numerical computing level, performing basis expansion methods on
function-valued variable data in matrix form as we mentioned is to
compute <span class="math inline">\((b_{ik})_{n\times p}\)</span>, where
<span class="math inline">\(b_{ik} = \int_\Omega f(t)\rho_k(t)
dt\)</span>.</p>
<!-- Usually the domain $\Omega$ of a function-valued variable $\{X(t),t\in\Omega\}$ is an interval.  -->
<div id="fourier-basis" class="section level3">
<h3>Fourier Basis</h3>
<p>On the interval <span class="math inline">\([t_0, t_0+T]\)</span>,
the Fourier basis consists of</p>
<p><span class="math display">\[
\frac{1}{2}, \quad \cos\left(\frac{2\pi}{T}k(x-t_0)\right), \quad
\sin\left(\frac{2\pi}{T}k(x-t_0)\right), \quad k = 1, 2, \dots
\]</span></p>
<div id="s4-class-fourier_series" class="section level4">
<h4>S4 Class <code>Fourier_series</code></h4>
<p>In the <strong>MECfda</strong> package, s4 class
<code>Fourier_series</code> represents a Fourier series of the form</p>
<p><span class="math display">\[
\frac{a_0}{2} + \sum_{k=1}^{p_a} a_k \cos\left(\frac{2\pi k
(x-t_0)}{T}\right) + \sum_{k=1}^{p_b} b_k \sin\left(\frac{2\pi k
(x-t_0)}{T}\right),\quad x \in [t_0, t_0+T].
\]</span></p>
<p>Its main slots include:</p>
<ul>
<li><strong><code>double_constant</code></strong>: The value of <span class="math inline">\(a_0\)</span>;</li>
<li><strong><code>cos</code></strong> and
<strong><code>sin</code></strong>: The coefficients <span class="math inline">\(a_k\)</span> and <span class="math inline">\(b_k\)</span> for the cosine and sine terms,
respectively;</li>
<li><strong><code>k_cos</code></strong> and
<strong><code>k_sin</code></strong>: The frequency values corresponding
to the cosine and sine coefficients;</li>
<li><strong><code>t_0</code></strong> and
<strong><code>period</code></strong>: The left endpoint, <span class="math inline">\(t_0\)</span>, and length, <span class="math inline">\(T\)</span>, of the domain (interval <span class="math inline">\([t_0, t_0+T]\)</span>), respectively.</li>
</ul>
<p>Additional methods such as <code>plot</code>,
<code>FourierSeries2fun</code>, and <code>extractCoef</code> are
provided for visualization, function evaluation, and coefficient
extraction.</p>
<!-- 
The method `FourierSeries2fun` is provided to compute the value of the summation function.
The argument `object`   should be an object of `Fourier_series` class.
The argument `x` is the value of independent variable $x$. 
-->
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>fsc <span class="ot">=</span> <span class="fu">Fourier_series</span>(</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>  <span class="at">double_constant =</span> <span class="dv">3</span>,</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>  <span class="at">cos =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">2</span><span class="sc">/</span><span class="dv">3</span>),</span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>  <span class="at">sin =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">7</span><span class="sc">/</span><span class="dv">5</span>),</span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>  <span class="at">k_cos =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,</span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a>  <span class="at">k_sin =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,</span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a>  <span class="at">t_0 =</span> <span class="dv">0</span>,</span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a>  <span class="at">period =</span> <span class="dv">1</span></span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a>)</span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a><span class="fu">plot</span>(fsc)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="fu">FourierSeries2fun</span>(fsc,<span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.05</span>))</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="co">#&gt;  [1]  2.1666667  3.1712610  3.6252757  3.4344848  2.7346112  1.8333333</span></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a><span class="co">#&gt;  [7]  1.0888125  0.7715265  0.9623175  1.5254623  2.1666667  2.5532270</span></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a><span class="co">#&gt; [13]  2.4497052  1.8164508  0.8324982 -0.1666667 -0.8133005 -0.8465074</span></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a><span class="co">#&gt; [19] -0.2132530  0.9074283  2.1666667</span></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a><span class="fu">extractCoef</span>(fsc)</span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a><span class="co">#&gt; $a_0</span></span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a><span class="co">#&gt; 0 </span></span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a><span class="co">#&gt; 3 </span></span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a><span class="co">#&gt; $a_k</span></span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a><span class="co">#&gt;         1         2 </span></span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a><span class="co">#&gt; 0.0000000 0.6666667 </span></span>
<span id="cb4-14"><a href="#cb4-14" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb4-15"><a href="#cb4-15" tabindex="-1"></a><span class="co">#&gt; $b_k</span></span>
<span id="cb4-16"><a href="#cb4-16" tabindex="-1"></a><span class="co">#&gt;   1   2 </span></span>
<span id="cb4-17"><a href="#cb4-17" tabindex="-1"></a><span class="co">#&gt; 1.0 1.4</span></span></code></pre></div>
<p>The object <code>fsc</code> represents the summation <span class="math display">\[\frac32 + \frac23 \cos(2\pi\cdot2x) + \sin(2\pi
x) + \frac75\sin(2\pi\cdot2x).\]</span></p>
</div>
</div>
<div id="b-spline-basis" class="section level3">
<h3>B-spline Basis</h3>
<p>A b-spline basis <span class="math inline">\(\{B_{i,p}(x)\}_{i=-p}^{k}\)</span> on the interval
<span class="math inline">\([t_0, t_{k+1}]\)</span> is defined
recursively as follows: - For <span class="math inline">\(p =
0\)</span>, <span class="math display">\[
  B_{i,0}(x) = \begin{cases}
    I_{(t_i, t_{i+1}]}(x), &amp; i = 0, 1, \dots, k, \\
    0, &amp; \text{otherwise}.
  \end{cases}
  \]</span> - For <span class="math inline">\(p &gt; 0\)</span>, the
recursion is given by <span class="math display">\[
  B_{i,p}(x) = \frac{x-t_i}{t_{i+p}-t_i} B_{i,p-1}(x) +
\frac{t_{i+p+1}-x}{t_{i+p+1}-t_{i+1}} B_{i+1,p-1}(x).
  \]</span></p>
<p>At discontinuities in the interval <span class="math inline">\((t_0,t_k)\)</span>, the basis function is defined
as its limit, <span class="math inline">\(B_{i,p}(x) = \lim_{t\to x}
B_{i,p}(t)\)</span>, to ensure continuity.</p>
<div id="s4-classes-bspline_basis-and-bspline_series" class="section level4">
<h4>S4 Classes <code>bspline_basis</code> and
<code>bspline_series</code></h4>
<p>The s4 class <code>bspline_basis</code> represents a b-spline basis,
<span class="math inline">\(\{B_{i,p}(x)\}_{i=-p}^{k}\)</span>, on the
interval <span class="math inline">\([t_0, t_{k+1}]\)</span>. Its key
slots include:</p>
<ul>
<li><strong><code>Boundary.knots</code></strong>: The boundary <span class="math inline">\([t_0, t_{k+1}]\)</span>, (default is <span class="math inline">\([0,1]\)</span>);</li>
<li><strong><code>knots</code></strong>: The internal spline knots,
<span class="math inline">\((t_1,\dots,t_k)\)</span>, (automatically
generated as equally spaced, <span class="math inline">\(t_j = t_0 +
j\cdot\frac{t_{k+1}-t_0}{k+1}\)</span>, if not assigned);</li>
<li><strong><code>intercept</code></strong>: Indicates whether an
intercept is included (default is <code>TRUE</code>);</li>
<li><strong><code>df</code></strong>: Degrees of freedom of the basis,
which is the number of the splines, equal to <span class="math inline">\(p + k + 1\)</span> (by default <span class="math inline">\(k =0\)</span> and <span class="math inline">\(\text{df} = p+1\)</span>);</li>
<li><strong><code>degree</code></strong>: The degree of the spline,
which is the degree of piecewise polynomials, <span class="math inline">\(p\)</span>, (default is 3).</li>
</ul>
<p>The s4 class <code>bspline_series</code> represents the linear
combination</p>
<p><span class="math display">\[
\sum_{i=0}^{k} b_i B_{i,p}(x),
\]</span></p>
<p>where the slot <strong><code>coef</code></strong> stores the
coefficients <span class="math inline">\(b_i\)</span> (<span class="math inline">\(i = 0,\dots,k\)</span>) and
<strong><code>bspline_basis</code></strong> specifies the associated
basis (represented by a <code>bspline_basis</code> object).</p>
<p>Methods such as <code>plot</code> and <code>bsplineSeries2fun</code>
are provided for visualization and function evaluation.</p>
<!-- 
The method `bsplineSeries2fun` is provided to compute the value of the summation function. 
The argument `object`   should be an object of the `bspline_series` class.
The argument `x` is the value of the independent variable $x$.
-->
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>bsb <span class="ot">=</span> <span class="fu">bspline_basis</span>(</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>  <span class="at">Boundary.knots =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">24</span>),</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>  <span class="at">df             =</span> <span class="dv">7</span>,</span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>  <span class="at">degree         =</span> <span class="dv">3</span></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>)</span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a>bss <span class="ot">=</span> <span class="fu">bspline_series</span>(</span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a>  <span class="at">coef =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">3</span><span class="sc">/</span><span class="dv">4</span>,<span class="dv">2</span><span class="sc">/</span><span class="dv">3</span>,<span class="dv">7</span><span class="sc">/</span><span class="dv">8</span>,<span class="dv">5</span><span class="sc">/</span><span class="dv">2</span>,<span class="dv">19</span><span class="sc">/</span><span class="dv">10</span>),</span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a>  <span class="at">bspline_basis =</span> bsb</span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a>)</span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a><span class="fu">plot</span>(bss)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="fu">bsplineSeries2fun</span>(bss,<span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">24</span>,<span class="fl">0.5</span>))</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a><span class="co">#&gt;  [1] 2.0000000 1.7677509 1.5690908 1.4011502 1.2610597 1.1459499 1.0529514</span></span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a><span class="co">#&gt;  [8] 0.9791948 0.9218107 0.8779297 0.8446824 0.8191993 0.7986111 0.7805266</span></span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a><span class="co">#&gt; [15] 0.7644676 0.7504340 0.7384259 0.7284433 0.7204861 0.7145544 0.7106481</span></span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a><span class="co">#&gt; [22] 0.7087674 0.7089120 0.7110822 0.7152778 0.7216857 0.7312404 0.7450629</span></span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a><span class="co">#&gt; [29] 0.7642747 0.7899969 0.8233507 0.8654574 0.9174383 0.9804145 1.0555073</span></span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a><span class="co">#&gt; [36] 1.1438380 1.2465278 1.3634786 1.4897151 1.6190430 1.7452675 1.8621942</span></span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a><span class="co">#&gt; [43] 1.9636285 2.0433759 2.0952418 2.1130317 2.0905511 2.0216053 1.9000000</span></span></code></pre></div>
<p>The object <code>bsb</code> represents <span class="math inline">\(\{B_{i,3}(x)\}_{i=-3}^{0}\)</span>, and the object
<code>bss</code> represents<br />
<span class="math display">\[2B_{i,-3}(x)+B_{i,-2}(x)+\frac34B_{i,-1}(x)+\frac23B_{i,0}(x)
+ \frac78B_{i,1}(x) +
\frac52B_{i,2}(x) +\frac{19}{10}B_{i,3}(x),\]</span> where <span class="math inline">\(x\in[t_0,t_4]\)</span> and <span class="math inline">\(t_0=0\)</span>, <span class="math inline">\(t_k =
t_{k-1}+6\)</span> ,<span class="math inline">\(k=1,2,3,4\)</span>.</p>
</div>
</div>
<div id="eigenfunction-basis" class="section level3">
<h3>Eigenfunction basis</h3>
<p>Suppose <span class="math inline">\(K(s,t)\in L^2(\Omega\times
\Omega)\)</span>, <span class="math inline">\(f(t)\in
L^2(\Omega)\)</span>. Then <span class="math inline">\(K\)</span>
induces an linear operator <span class="math inline">\(\mathcal{K}\)</span> by <span class="math display">\[(\mathcal{K}f)(x) = \int_{\Omega}
K(t,x)f(t)dt\]</span> If <span class="math inline">\(\xi \in
L^2(\Omega)\)</span> such that <span class="math display">\[\mathcal{K}\xi = \lambda \xi\]</span> where <span class="math inline">\(\lambda\in \mathbb{C}\)</span>, we call <span class="math inline">\(\xi\)</span> an eigenfunction/eigenvector of <span class="math inline">\(\mathcal{K}\)</span>, and <span class="math inline">\(\lambda\)</span> an eigenvalue associated with
<span class="math inline">\(\xi\)</span>.</p>
<p>For a stochastic process <span class="math inline">\(\{X(t),t\in\Omega\}\)</span> we call the
orthogonal basis, <span class="math inline">\(\{\xi_k\}_{k=1}^\infty\)</span> corresponding to
eigenvalues <span class="math inline">\(\{\lambda_k\}_{k=1}^\infty\)</span> (<span class="math inline">\(\lambda_1\geq\lambda_2\geq\dots\)</span>), induced
by <span class="math display">\[K(s,t)=\operatorname{Cov}(X(t),X(s))\]</span> a
functional principal component (FPC) basis for <span class="math inline">\(L^2(\Omega)\)</span>.</p>
<p>The eigenfunction basis relies on the covariance function <span class="math inline">\(K(s,t)\)</span>. And we usually cannot
analytically express the equation of the basis funcitons in
eigenfunction basis. In practice, the covariance function is estimated
from the data and the eigenfunctions are computed numerically.</p>
</div>
<div id="numerical-basis" class="section level3">
<h3>Numerical Basis</h3>
<p>Sometimes, analytical expressions for the basis functions are not
available. In these cases, they can be represented numerically. Let
<span class="math inline">\(\{\rho_k\}_{k=1}^\infty\)</span> denote a
basis of the function space. We can numerically approximate the basis by
storing the values of a finite subset of these functions at a finite set
of points in the domain, i.e., <span class="math inline">\(\rho_k(t_j)\)</span> for <span class="math inline">\(k=1,\dots,p\)</span> and <span class="math inline">\(j=1,\dots,m\)</span>.</p>
<div id="s4-class-numeric_basis-and-numericbasis_series" class="section level4">
<h4>S4 Class <code>numeric_basis</code> and
<code>numericBasis_series</code></h4>
<p>In this package, the s4 class <code>numeric_basis</code> is designed
to represent a finite sequence of functions <span class="math inline">\(\{\rho_k\}_{k=1}^p\)</span> by their values at a
finite set of points within their domain. In this context, all functions
share the same domain, which is assumed to be an interval. The key slots
include:</p>
<ul>
<li><strong><code>basis_function</code></strong>: The matrix <span class="math inline">\((\zeta_{jk})_{m \times p}\)</span>, where each
element is defined as <span class="math inline">\(\zeta_{jk} =
\rho_k(t_j)\)</span> for <span class="math inline">\(j = 1, \dots,
m\)</span> and <span class="math inline">\(k = 1, \dots, p\)</span>. In
this matrix, each row corresponds to a point in the domain, and each
column corresponds to a specific basis function.</li>
<li><strong><code>t_points</code></strong>: A numeric vector that
represents the points in the domain at which the basis functions are
evaluated. The <span class="math inline">\(j\)</span>-th element of this
vector corresponds to the <span class="math inline">\(j\)</span>-th row
of the <code>basis_function</code> matrix.</li>
<li><strong><code>t_0</code></strong> and
<strong><code>period</code></strong>: The left endpoint and length of
the domain, respectively.</li>
</ul>
<p>Additionally, the package provides an s4 class
<code>numericBasis_series</code>, which represents a linear combination
of the basis functions represented by a <code>numeric_basis</code>
object. The key slots include:</p>
<ul>
<li><strong><code>coef</code></strong>: The linear coefficients for the
summation series.</li>
<li><strong><code>numeric_basis</code></strong>: Function basis as
represented by a <code>numeric_basis</code> object.</li>
</ul>
</div>
<div id="function-basis2fun" class="section level4">
<h4>Function <code>basis2fun</code></h4>
<p>The generic function <code>basis2fun</code> is provided for
<code>Fourier_series</code>, <code>bspline_series</code>, and
<code>numericBasis_series</code> objects. For a
<code>Fourier_series</code> object, it is equivalent to
<code>FourierSeries2fun</code>; for a <code>bspline_series</code>
object, it is equivalent to <code>bsplineSeries2fun</code>; For a
<code>numericBasis_series</code> object, it is equivalent to
<code>numericBasisSeries2fun</code>.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="fu">basis2fun</span>(fsc,<span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.05</span>))</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a><span class="co">#&gt;  [1]  2.1666667  3.1712610  3.6252757  3.4344848  2.7346112  1.8333333</span></span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a><span class="co">#&gt;  [7]  1.0888125  0.7715265  0.9623175  1.5254623  2.1666667  2.5532270</span></span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a><span class="co">#&gt; [13]  2.4497052  1.8164508  0.8324982 -0.1666667 -0.8133005 -0.8465074</span></span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a><span class="co">#&gt; [19] -0.2132530  0.9074283  2.1666667</span></span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a><span class="fu">basis2fun</span>(bss,<span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">24</span>,<span class="fl">0.5</span>))</span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a><span class="co">#&gt;  [1] 2.0000000 1.7677509 1.5690908 1.4011502 1.2610597 1.1459499 1.0529514</span></span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a><span class="co">#&gt;  [8] 0.9791948 0.9218107 0.8779297 0.8446824 0.8191993 0.7986111 0.7805266</span></span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a><span class="co">#&gt; [15] 0.7644676 0.7504340 0.7384259 0.7284433 0.7204861 0.7145544 0.7106481</span></span>
<span id="cb7-10"><a href="#cb7-10" tabindex="-1"></a><span class="co">#&gt; [22] 0.7087674 0.7089120 0.7110822 0.7152778 0.7216857 0.7312404 0.7450629</span></span>
<span id="cb7-11"><a href="#cb7-11" tabindex="-1"></a><span class="co">#&gt; [29] 0.7642747 0.7899969 0.8233507 0.8654574 0.9174383 0.9804145 1.0555073</span></span>
<span id="cb7-12"><a href="#cb7-12" tabindex="-1"></a><span class="co">#&gt; [36] 1.1438380 1.2465278 1.3634786 1.4897151 1.6190430 1.7452675 1.8621942</span></span>
<span id="cb7-13"><a href="#cb7-13" tabindex="-1"></a><span class="co">#&gt; [43] 1.9636285 2.0433759 2.0952418 2.1130317 2.0905511 2.0216053 1.9000000</span></span></code></pre></div>
</div>
</div>
<div id="basis-expansion-methods-for-the-functional_variable-class" class="section level3">
<h3>Basis expansion methods for the <code>functional_variable</code>
class</h3>
<p>The <strong>MECfda</strong> pakcage provide the methods
<code>fourier_basis_expansion</code>,
<code>bspline_basis_expansion</code>, <code>FPC_basis_expansion</code>,
and <code>numeric_basis_expansion</code> for the class
<code>functional_variable</code>, which perform basis expansion using
Fourier basis, b-spline basis, functional principal component basis, and
numerical basis respectively.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="fu">data</span>(MECfda.data.sim.<span class="fl">0.0</span>)</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>fv <span class="ot">=</span> MECfda.data.sim.<span class="fl">0.0</span><span class="sc">$</span>FC[[<span class="dv">1</span>]]</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>BE.fs <span class="ot">=</span> <span class="fu">fourier_basis_expansion</span>(fv,<span class="dv">5</span><span class="dt">L</span>)</span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a>BE.bs <span class="ot">=</span> <span class="fu">bspline_basis_expansion</span>(fv,<span class="dv">5</span><span class="dt">L</span>,<span class="dv">3</span><span class="dt">L</span>)</span></code></pre></div>
</div>
</div>
<div id="numerical-computation-of-integrals" class="section level2">
<h2>Numerical Computation of Integrals</h2>
<p>The package approximates the integral</p>
<p><span class="math display">\[
\int_{\Omega} \rho_{k}(t) X_{i}(t) \, dt \approx \frac{\mu(\Omega)}{|T|}
\sum_{t \in T} \rho_{k}(t) X_{i}(t),
\]</span></p>
<p>where <span class="math inline">\(\mu(\cdot)\)</span> denote the
Lebesgue measure. <span class="math inline">\(T\)</span> denotes the set
of measurement time points for <span class="math inline">\(X_i(t)\)</span> and <span class="math inline">\(|T|\)</span> represents the cardinal number of
<span class="math inline">\(T\)</span>.</p>
</div>
</div>
<div id="scalar-on-function-linear-regression-in-mecfda" class="section level1">
<h1>Scalar-on-Function Linear Regression in <strong>MECfda</strong></h1>
<div id="fcregression" class="section level2">
<h2>fcRegression</h2>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="fu">fcRegression</span>(Y, FC, Z, formula.Z, <span class="at">family =</span> <span class="fu">gaussian</span>(<span class="at">link =</span> <span class="st">&quot;identity&quot;</span>),</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>             <span class="at">basis.type =</span> <span class="fu">c</span>(<span class="st">&quot;Fourier&quot;</span>, <span class="st">&quot;Bspline&quot;</span>), <span class="at">basis.order =</span> <span class="dv">6</span><span class="dt">L</span>, </span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>             <span class="at">bs_degree =</span> <span class="dv">3</span>)</span></code></pre></div>
<p>The <strong>MECfda</strong> package provides a function,
<code>fcRegression</code>, for fitting generalized linear mixed-effect
models—including ordinary linear models and generalized linear models
with fixed and random effects—by discretizing function-valued covariates
using basis expansion. The function can solve a linear model of the
form</p>
<p><span class="math display">\[
g\bigl(E(Y_i\mid X_i,Z_i)\bigr) = \sum_{l=1}^{L} \int_{\Omega_l}
\beta_l(t) X_{li}(t) \, dt + (1,Z_i^T)\gamma.
\]</span></p>
<p>It supports one or multiple function-valued covariates as fixed
effects, and zero, one, or multiple scalar covariates, which can be
specified as either fixed or random effects. The response variable,
function-valued covariates, and scalar covariates are supplied
separately via the arguments <code>Y</code>, <code>FC</code>, and
<code>Z</code>, respectively, allowing great flexibility in data
format.</p>
<ul>
<li><p><strong>Response Variable:</strong><br />
The response can be provided as an atomic vector, a one-column matrix,
or a data frame. However, a one-column data frame or matrix with a
column name is recommended so that the response variable’s name is
clearly specified.</p></li>
<li><p><strong>Function-Valued Covariates:</strong><br />
The function-valued covariates can be input as a
<code>functional_variable</code> object, a matrix, a data frame, or a
list of these objects. If a single <code>functional_variable</code>
object (or matrix or data frame) is provided via <code>FC</code>, the
model includes one function-valued covariate. If a list is provided, the
model accommodates multiple function-valued covariates, with each
element in the list representing a distinct covariate.</p></li>
<li><p><strong>Scalar Covariates:</strong><br />
Scalar covariates can be provided as a matrix, data frame, atomic
vector, or even <code>NULL</code> if no scalar covariates are present.
If <code>Z</code> is omitted or set to <code>NULL</code>, no scalar
covariate is included and the argument <code>formula.Z</code> should
also be <code>NULL</code> or omitted. When an atomic vector is used for
<code>Z</code>, it represents a single scalar covariate (without a
name). Hence, even when only one scalar covariate is included, it is
recommended to supply it as a matrix or data frame with a column name.
The <code>formula.Z</code> argument specifies which parts of
<code>Z</code> to use and whether scalar covariates should be treated as
fixed or random effects.</p></li>
</ul>
<p>Other key arguments include:</p>
<ul>
<li><strong><code>family</code>:</strong> Specifies the response
variable’s distribution and the link function to be used.</li>
<li><strong><code>basis.type</code>:</strong> Indicates the type of
basis function for the expansion. Options include
<code>&#39;Fourier&#39;</code>, <code>&#39;Bspline&#39;</code>, and <code>&#39;FPC&#39;</code>,
corresponding to the Fourier basis, b-spline basis, and functional
principal component basis, respectively.</li>
<li><strong><code>basis.order</code>:</strong> Specifies the number of
basis functions to use. For the Fourier basis (i.e., <span class="math inline">\(\frac{1}{2},\ \sin(kt),\ \cos(kt)\)</span> for
<span class="math inline">\(k = 1, \dots, p_f\)</span>),
<code>basis.order</code> equals <span class="math inline">\(p_f\)</span>. For the b-spline basis <span class="math inline">\(\{B_{i,p}(x)\}_{i=-p}^{k}\)</span>,
<code>basis.order</code> is set to <span class="math inline">\(k+p+1\)</span>. For the FPC basis,
<code>basis.order</code> represents the number of functional principal
components.</li>
<li><strong><code>bs_degree</code>:</strong> Specifies the degree of the
piecewise polynomials for the b-spline basis; this argument is only
necessary when using the b-spline basis.</li>
</ul>
<p>The function returns an s3 object of class <code>fcRegression</code>,
which is a list containing the following elements:</p>
<ol style="list-style-type: decimal">
<li><strong>regression_result:</strong> The result of the regression
analysis.</li>
<li><strong>FC.BasisCoefficient:</strong> A list of
<code>Fourier_series</code>, <code>bspline_series</code>, or
<code>numericBasis_series</code> objects representing the
function-valued linear coefficients of the covariates.</li>
<li><strong>function.basis.type:</strong> The type of basis used.</li>
<li><strong>basis.order:</strong> The number of basis functions used, as
specified in the input.</li>
<li><strong>data:</strong> The original data provided to the model.</li>
<li><strong>bs_degree:</strong> The degree of the b-spline basis, same
as specified in the input (included only when the b-spline basis is
used).</li>
</ol>
<p>Additionally, the <code>predict</code> method can be used to obtain
predicted values from the fitted model, and the <code>fc.beta</code>
method is available to evaluate the estimated function-valued
coefficient parameters <span class="math inline">\(\beta_l(t)\)</span>.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="fu">data</span>(MECfda.data.sim.<span class="fl">0.0</span>)</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>res <span class="ot">=</span> <span class="fu">fcRegression</span>(<span class="at">FC =</span> MECfda.data.sim.<span class="fl">0.0</span><span class="sc">$</span>FC, </span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>                   <span class="at">Y=</span>MECfda.data.sim.<span class="fl">0.0</span><span class="sc">$</span>Y, </span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a>                   <span class="at">Z=</span>MECfda.data.sim.<span class="fl">0.0</span><span class="sc">$</span>Z,</span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a>                   <span class="at">family =</span> <span class="fu">gaussian</span>(<span class="at">link =</span> <span class="st">&quot;identity&quot;</span>),</span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a>                   <span class="at">basis.order =</span> <span class="dv">5</span>, <span class="at">basis.type =</span> <span class="fu">c</span>(<span class="st">&#39;Bspline&#39;</span>),</span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a>                   <span class="at">formula.Z =</span> <span class="sc">~</span> Z_1 <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Z_2))</span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a>t <span class="ot">=</span> (<span class="dv">0</span><span class="sc">:</span><span class="dv">100</span>)<span class="sc">/</span><span class="dv">100</span></span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x =</span> t, <span class="at">y =</span> <span class="fu">fc.beta</span>(res,<span class="dv">1</span>,t), <span class="at">ylab =</span> <span class="fu">expression</span>(beta[<span class="dv">1</span>](t)))</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x =</span> t, <span class="at">y =</span> <span class="fu">fc.beta</span>(res,<span class="dv">2</span>,t), <span class="at">ylab =</span> <span class="fu">expression</span>(beta[<span class="dv">2</span>](t)))</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="fu">data</span>(MECfda.data.sim.<span class="fl">1.0</span>)</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a><span class="fu">predict</span>(<span class="at">object =</span> res, <span class="at">newData.FC =</span> MECfda.data.sim.<span class="fl">1.0</span><span class="sc">$</span>FC,</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>        <span class="at">newData.Z =</span> MECfda.data.sim.<span class="fl">1.0</span><span class="sc">$</span>Z)</span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a><span class="co">#&gt;        1        2        3        4        5 </span></span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a><span class="co">#&gt; 6.500129 5.690171 2.388979 5.441011 4.821000</span></span></code></pre></div>
</div>
<div id="fcqr" class="section level2">
<h2>fcQR</h2>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="fu">fcQR</span>(Y, FC, Z, formula.Z, <span class="at">tau =</span> <span class="fl">0.5</span>, <span class="at">basis.type =</span> <span class="fu">c</span>(<span class="st">&quot;Fourier&quot;</span>, <span class="st">&quot;Bspline&quot;</span>),</span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>     <span class="at">basis.order =</span> <span class="dv">6</span><span class="dt">L</span>, <span class="at">bs_degree =</span> <span class="dv">3</span>)</span></code></pre></div>
<p>The <strong>MECfda</strong> package provides a function,
<code>fcRegression</code>, for fitting quantile linear regression models
by discretizing function-valued covariates using basis expansion. The
function can solve a linear model of the form</p>
<p><span class="math display">\[Q_{Y_i|X_i,Z_i}(\tau) =
\sum_{l=1}^L\int_{\Omega_l} \beta_l(\tau,t) X_{li}(t) dt
+  (1,Z_i^T)\gamma.\]</span> The function supports one or multiple
function-valued covariates, as well as zero, one, or multiple
scalar-valued covariates. Data input follows the same guidelines as for
the <code>fcRegression</code> function, and the treatment of scalar
covariates is determined by the <code>formula.Z</code> argument. The
primary difference between <code>fcQR</code> and
<code>fcRegression</code> is that the quantile linear regression model
does not incorporate random effects. The quantile <span class="math inline">\(\tau\)</span> is specified by the argument
<code>tau</code>, and the type and parameters of the basis functions are
defined by the <code>basis.type</code>, <code>basis.order</code>, and
<code>bs_degree</code> arguments, just as in
<code>fcRegression</code>.</p>
<p>The function returns an s3 object of class <code>fcQR</code>, which
is a list containing the following elements:</p>
<ol style="list-style-type: decimal">
<li><strong>regression_result:</strong> The result of the regression
analysis.</li>
<li><strong>FC.BasisCoefficient:</strong> A list of
<code>Fourier_series</code>, <code>bspline_series</code>, or
<code>numericBasis_series</code> objects representing the
function-valued linear coefficients of the covariates.</li>
<li><strong>function.basis.type:</strong> The type of basis used.</li>
<li><strong>basis.order:</strong> The number of basis functions used, as
specified in the input.</li>
<li><strong>data:</strong> The original data provided to the model.</li>
<li><strong>bs_degree:</strong> The degree of the b-spline basis, same
as specified in the input (included only when the b-spline basis is
used).</li>
</ol>
<p>Additionally, the <code>predict</code> method can be used to obtain
predicted values from the fitted model, and the <code>fc.beta</code>
method is available to evaluate the estimated function-valued
coefficient parameters <span class="math inline">\(\beta_l(t)\)</span>.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="fu">data</span>(MECfda.data.sim.<span class="fl">0.0</span>)</span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a>res <span class="ot">=</span> <span class="fu">fcQR</span>(<span class="at">FC =</span> MECfda.data.sim.<span class="fl">0.0</span><span class="sc">$</span>FC, </span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a>           <span class="at">Y=</span>MECfda.data.sim.<span class="fl">0.0</span><span class="sc">$</span>Y, </span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a>           <span class="at">Z=</span>MECfda.data.sim.<span class="fl">0.0</span><span class="sc">$</span>Z,</span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a>           <span class="at">tau =</span> <span class="fl">0.5</span>,</span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a>           <span class="at">basis.order =</span> <span class="dv">5</span>, <span class="at">basis.type =</span> <span class="fu">c</span>(<span class="st">&#39;Bspline&#39;</span>),</span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a>           <span class="at">formula.Z =</span> <span class="sc">~</span> .)</span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a>t <span class="ot">=</span> (<span class="dv">0</span><span class="sc">:</span><span class="dv">100</span>)<span class="sc">/</span><span class="dv">100</span></span>
<span id="cb14-9"><a href="#cb14-9" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x =</span> t, <span class="at">y =</span> <span class="fu">fc.beta</span>(res,<span class="dv">1</span>,t), <span class="at">ylab =</span> <span class="fu">expression</span>(beta[<span class="dv">1</span>](t)))</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x =</span> t, <span class="at">y =</span> <span class="fu">fc.beta</span>(res,<span class="dv">2</span>,t), <span class="at">ylab =</span> <span class="fu">expression</span>(beta[<span class="dv">2</span>](t)))</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="fu">data</span>(MECfda.data.sim.<span class="fl">1.0</span>)</span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a><span class="fu">predict</span>(<span class="at">object =</span> res, <span class="at">newData.FC =</span> MECfda.data.sim.<span class="fl">1.0</span><span class="sc">$</span>FC,</span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a>        <span class="at">newData.Z =</span> MECfda.data.sim.<span class="fl">1.0</span><span class="sc">$</span>Z)</span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a><span class="co">#&gt;        1        2        3        4        5 </span></span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a><span class="co">#&gt; 6.497759 5.682573 2.404464 5.440699 4.830085</span></span></code></pre></div>
</div>
</div>
<div id="measurement-error-models-and-bias-correction-estimation-methods" class="section level1">
<h1>Measurement Error Models and Bias Correction Estimation Methods</h1>
<p>Data collected in real-world settings often include measurement
error, especially function-valued data. Measurement error in a data set
may result in estimation bias. The *MECfda** package also provides bias
correction estimation method functions for certain linear regression
models for use with data containing measurement error.</p>
<div id="me.fcregression_mem" class="section level3">
<h3>ME.fcRegression_MEM</h3>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="fu">ME.fcRegression_MEM</span>(</span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a>  data.Y,</span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a>  data.W,</span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a>  data.Z,</span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a>  <span class="at">method =</span> <span class="fu">c</span>(<span class="st">&quot;UP_MEM&quot;</span>, <span class="st">&quot;MP_MEM&quot;</span>, <span class="st">&quot;average&quot;</span>),</span>
<span id="cb17-6"><a href="#cb17-6" tabindex="-1"></a>  <span class="at">t_interval =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb17-7"><a href="#cb17-7" tabindex="-1"></a>  <span class="at">t_points =</span> <span class="cn">NULL</span>,</span>
<span id="cb17-8"><a href="#cb17-8" tabindex="-1"></a>  <span class="at">d =</span> <span class="dv">3</span>,</span>
<span id="cb17-9"><a href="#cb17-9" tabindex="-1"></a>  <span class="at">family.W =</span> <span class="fu">c</span>(<span class="st">&quot;gaussian&quot;</span>, <span class="st">&quot;poisson&quot;</span>),</span>
<span id="cb17-10"><a href="#cb17-10" tabindex="-1"></a>  <span class="at">family.Y =</span> <span class="st">&quot;gaussian&quot;</span>,</span>
<span id="cb17-11"><a href="#cb17-11" tabindex="-1"></a>  formula.Z,</span>
<span id="cb17-12"><a href="#cb17-12" tabindex="-1"></a>  <span class="at">basis.type =</span> <span class="fu">c</span>(<span class="st">&quot;Fourier&quot;</span>, <span class="st">&quot;Bspline&quot;</span>),</span>
<span id="cb17-13"><a href="#cb17-13" tabindex="-1"></a>  <span class="at">basis.order =</span> <span class="cn">NULL</span>,</span>
<span id="cb17-14"><a href="#cb17-14" tabindex="-1"></a>  <span class="at">bs_degree =</span> <span class="dv">3</span>,</span>
<span id="cb17-15"><a href="#cb17-15" tabindex="-1"></a>  <span class="at">smooth =</span> <span class="cn">FALSE</span>,</span>
<span id="cb17-16"><a href="#cb17-16" tabindex="-1"></a>  <span class="at">silent =</span> <span class="cn">TRUE</span></span>
<span id="cb17-17"><a href="#cb17-17" tabindex="-1"></a>)</span></code></pre></div>
<p>Wearable monitoring devices permit the continuous monitoring of
biological processes, such as blood glucose metabolism, and behaviors,
such as sleep quality and physical activity.<br />
Continuous monitoring often collect data in 60-second epochs over
multiple days, resulting in high-dimensional multi-level longitudinal
curves that are best described and analyzed as multi-level functional
data.<br />
Although researchers have previously addressed measurement error in
scalar covariates prone to error, less work has been done for correcting
measurement error in multi-level high dimensional curves prone to
heteroscedastic measurement error. Therefore, Luan et. al. proposed
mixed effects-based-model-based (MEM) methods for bias correction due to
measurement error in multi-level functional data from the exponential
family of distributions that are prone to complex heteroscedastic
measurement error.</p>
<p>They first developed MEM methods to adjust for biases due to the
presence of measurement error in multi-level generalized functional
regression models.<br />
They assumed that the distributions of the function-valued covariates
prone to measurement error belong to the exponential family. This
assumption allows for a more general specification of the distributions
of error-prone functional covariates compared to current approaches that
often entail normality assumptions for these observed measures. The
approach adopted by Luan et al. allows a nonlinear association between
the true measurement and the observed measurement prone to measurement
error.<br />
Second, they treated the random errors in the observed measures as
complex heteroscedastic errors from the Gaussian distribution with
covariance error functions. Third, these methods can be used to evaluate
relationships between multi-level function-valued covariates with
complex measurement error structures and scalar outcomes with
distributions in the exponential family.<br />
Fourth, they treat the function-valued covariate as an observed measure
of the true function-valued unobserved latent covariate.<br />
Additionally, these methods employ a point-wise method for fitting the
multi-level functional MEM approach, avoiding the need to compute
complex and intractable integrals that would be required in traditional
approaches for reducing biases due to measurement error in multi-level
functional data <span class="citation">[7]</span>.</p>
<p>Their statistical model is as follows: <span class="math display">\[\begin{align*}
  &amp;g(E(Y_i|X_i,Z_i)) = \int_{\Omega} \beta(t) X_{i}(t) dt +
(1,Z_i^T)\gamma\\
  &amp;h(E(W_{ij}(t)|X_i(t))) = X_i(t)\\
  &amp;X_i(t) = \mu_x(t) + \varepsilon_{xi}(t)
\end{align*}\]</span> where the response variable <span class="math inline">\(Y_i\)</span> and scalar-valued covariates <span class="math inline">\(Z_i\)</span> are measured without error,
function-valued covariate <span class="math inline">\(X_i(t)\)</span> is
repeatedly measured with error as <span class="math inline">\(W_{ij}(t)\)</span>. The model also includes the
following assumptions:</p>
<ol style="list-style-type: decimal">
<li><span class="math inline">\(Y_i|X_i,Z_i\sim EF(\cdot)\)</span>,
<span class="math inline">\(EF\)</span> refers to an exponential family
distribution.</li>
<li><span class="math inline">\(g(\cdot)\)</span> and <span class="math inline">\(h(\cdot)\)</span> are known to be strictly
monotone, twice continuously differentiable functions.</li>
<li><span class="math inline">\(Cov\{X_i(t),W_{ij}(t)\} \neq
0\)</span>,</li>
<li><span class="math inline">\(W_{ij}(t)|X_i(t)\sim
EF(\cdot)\)</span></li>
<li><span class="math inline">\(f_{Y_i|W_{ij}(t),X_i(t)}(\cdot) =
f_{Y_i|X_i(t)}(\cdot)\)</span>, <span class="math inline">\(f\)</span>
refers to probability density function.<br />
</li>
<li><span class="math inline">\(X_i(t)\sim
GP\{\mu_x(t),\Sigma_{xx}\}\)</span>, <span class="math inline">\(GP\)</span> refers to the Gaussian process.</li>
</ol>
<p>They proposed a MEM estimation method to correct for bias caused by
the presence of measurement error in the function-valued covariate. This
method allows for the investigation of a nonlinear measurement error
model, in which the relationship between the true and observed
measurements is not constrained to be linear, and the distribution
assumption for the observed measurement is relaxed to encompass the
exponential family rather than being limited to a Gaussian
distribution.</p>
<p>The MEM approach is a two stage method that employs functional
mixed-effects models. The first stage of the MEM approach involves using
a functional mixed-effects model<br />
to approximate the true measure <span class="math inline">\(X_i(t)\)</span> with the repeated observed
measurement <span class="math inline">\(W_{ij}(t)\)</span>. The MEM
approach is primarily based on the assumptions that <span class="math inline">\(h[E\{W_{ij}(t)|X_i(t)\}] = X_i(t)\)</span> and
<span class="math inline">\(X_i(t) = \mu_x(t) +
\varepsilon_{xi}(t)\)</span>. That is, in the functional mixed-effects
model containing one fixed intercept and one random intercept, the
random intercept is assumed to to be the subject-wise deviation of <span class="math inline">\(X_i(t)\)</span> from the mean process <span class="math inline">\(\mu_x(t)\)</span>, and the fixed intercept is
assumed to represent <span class="math inline">\(\mu_x(t)\)</span>. The
second stage involves replacing <span class="math inline">\(X_i(t)\)</span> in the regression model with the
resulting approximation of <span class="math inline">\(X_i(t)\)</span>
from the first stage. The MEM approach employs point-wise (UP_MEM) and
multi-point-wise (MP_MEM) estimation procedures to avoid potential
computational complexities caused by analyses of multi-level functional
data and computations of potentially intractable and complex
integrals.</p>
<p>The <strong>MECfda</strong> package provides the function
<code>ME.fcRegression_MEM</code> for applying bias-correction estimation
methods. In this function, the response variable, function-valued
covariates, and scalar covariates are supplied separately via the
arguments <code>data.Y</code>, <code>data.W</code>, and
<code>data.Z</code>, respectively.</p>
<ul>
<li><p><strong><code>data.Y</code> (Response Variable):</strong><br />
The response variable can be provided as an atomic vector, a one-column
matrix, or a data frame. However, a one-column data frame with a column
name is recommended so that the response variable is explicitly
identified.</p></li>
<li><p><strong><code>data.W</code> (Measurement Data):</strong><br />
This argument represents <span class="math inline">\(W\)</span>, the
observed measurement of the true function-valued covariate <span class="math inline">\(X\)</span> in the statistical model. It should be
provided as a three-dimensional array where each row corresponds to a
subject, each column to a measurement (time) point, and each layer to a
separate observation.</p></li>
<li><p><strong><code>data.Z</code> (Scalar Covariates):</strong><br />
The scalar covariates can be input as a matrix, data frame, or atomic
vector. If the model does not include any scalar covariates,
<code>data.Z</code> can be omitted or set to <code>NULL</code>. For a
single scalar covariate, although an atomic vector is acceptable, a data
frame or matrix with a column name is recommended. For multiple scalar
covariates, use a matrix or data frame with named columns.</p></li>
</ul>
<p>Other key arguments include:</p>
<ul>
<li><strong><code>method</code>:</strong> Specifies the method for
constructing the substitute for <span class="math inline">\(X\)</span>;
available options are <code>&#39;UP_MEM&#39;</code>, <code>&#39;MP_MEM&#39;</code>, and
<code>&#39;average&#39;</code>.</li>
<li><strong><code>t_interval</code>:</strong> Defines the domain of the
function-valued covariate as a two-element vector (default is
<code>c(0,1)</code>, representing the interval <span class="math inline">\([0,1]\)</span>).</li>
<li><strong><code>t_points</code>:</strong> Specifies the sequence of
measurement time points (default is <code>NULL</code>).</li>
<li><strong><code>d</code>:</strong> When using the <code>MP_MEM</code>
method, this argument sets the number of measurement points involved
(default is 3, which is also the minimum value).</li>
<li><strong><code>family.W</code>:</strong> Specifies the distribution
of <span class="math inline">\(W\)</span> given <span class="math inline">\(X\)</span>; available options are
<code>&#39;gaussian&#39;</code> and <code>&#39;poisson&#39;</code>.</li>
<li><strong><code>family.Y</code>:</strong> Describes the error
distribution and link function for the response variable (see
<code>stats::family</code> for details).</li>
<li><strong><code>formula.Z</code>:</strong> Indicates which parts of
<code>data.Z</code> to include in the model and whether to treat the
scalar covariates as fixed or random effects.</li>
<li><strong><code>basis.type</code>:</strong> Indicates the type of
basis function for the expansion. Options include
<code>&#39;Fourier&#39;</code>, <code>&#39;Bspline&#39;</code>, and <code>&#39;FPC&#39;</code>,
corresponding to the Fourier basis, b-spline basis, and functional
principal component basis, respectively.</li>
<li><strong><code>basis.order</code>:</strong> Specifies the number of
basis functions to use. For the Fourier basis (i.e., <span class="math inline">\(\frac{1}{2},\ \sin(kt),\ \cos(kt)\)</span> for
<span class="math inline">\(k = 1, \dots, p_f\)</span>),
<code>basis.order</code> equals <span class="math inline">\(p_f\)</span>. For the b-spline basis <span class="math inline">\(\{B_{i,p}(x)\}_{i=-p}^{k}\)</span>,
<code>basis.order</code> is set to <span class="math inline">\(k+p+1\)</span>. For the FPC basis,
<code>basis.order</code> represents the number of functional principal
components.</li>
<li><strong><code>bs_degree</code>:</strong> Specifies the degree of the
piecewise polynomials for the b-spline basis; this argument is only
necessary when using the b-spline basis.</li>
<li><strong><code>smooth</code>:</strong> Specifies whether to smooth
the substitution for <span class="math inline">\(X\)</span> (default is
<code>FALSE</code>).</li>
<li><strong><code>silent</code>:</strong> Controls whether the function
displays its progress during execution (default is
<code>TRUE</code>).</li>
</ul>
<p>The function <code>ME.fcRegression_MEM</code> returns an object of
class <code>fcRegression</code>.</p>
<p>The package also provide a function, <code>MEM_X_hat</code>. This
function can return the <span class="math inline">\(\hat X(t)\)</span>
in this bias-correction method.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="fu">data</span>(MECfda.data.sim.<span class="fl">0.1</span>)</span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a>res <span class="ot">=</span> <span class="fu">ME.fcRegression_MEM</span>(<span class="at">data.Y =</span> MECfda.data.sim.<span class="fl">0.1</span><span class="sc">$</span>Y,</span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a>                          <span class="at">data.W =</span> MECfda.data.sim.<span class="fl">0.1</span><span class="sc">$</span>W,</span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a>                          <span class="at">data.Z =</span> MECfda.data.sim.<span class="fl">0.1</span><span class="sc">$</span>Z,</span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a>                          <span class="at">method =</span> <span class="st">&#39;UP_MEM&#39;</span>,</span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a>                          <span class="at">family.W =</span> <span class="st">&quot;gaussian&quot;</span>,</span>
<span id="cb18-7"><a href="#cb18-7" tabindex="-1"></a>                          <span class="at">basis.type =</span> <span class="st">&#39;Bspline&#39;</span>)</span></code></pre></div>
</div>
<div id="me.fcqr_iv.simex" class="section level3">
<h3>ME.fcQR_IV.SIMEX</h3>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="fu">ME.fcQR_IV.SIMEX</span>(</span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a>  data.Y,</span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a>  data.W,</span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a>  data.Z,</span>
<span id="cb19-5"><a href="#cb19-5" tabindex="-1"></a>  data.M,</span>
<span id="cb19-6"><a href="#cb19-6" tabindex="-1"></a>  <span class="at">tau =</span> <span class="fl">0.5</span>,</span>
<span id="cb19-7"><a href="#cb19-7" tabindex="-1"></a>  <span class="at">t_interval =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb19-8"><a href="#cb19-8" tabindex="-1"></a>  <span class="at">t_points =</span> <span class="cn">NULL</span>,</span>
<span id="cb19-9"><a href="#cb19-9" tabindex="-1"></a>  formula.Z,</span>
<span id="cb19-10"><a href="#cb19-10" tabindex="-1"></a>  <span class="at">basis.type =</span> <span class="fu">c</span>(<span class="st">&quot;Fourier&quot;</span>, <span class="st">&quot;Bspline&quot;</span>),</span>
<span id="cb19-11"><a href="#cb19-11" tabindex="-1"></a>  <span class="at">basis.order =</span> <span class="cn">NULL</span>,</span>
<span id="cb19-12"><a href="#cb19-12" tabindex="-1"></a>  <span class="at">bs_degree =</span> <span class="dv">3</span></span>
<span id="cb19-13"><a href="#cb19-13" tabindex="-1"></a>)</span></code></pre></div>
<p>Health a major concerns for many people, and as technology advances,
wearable devices have become the mainstream method for monitoring and
evaluating individual physical activity levels. Despite personal
preferences in brands and feature design, the accuracy of the data
presented is what makes the device a great product. These functional
data collected from devices are generally considered more accurate and
subjective compared to other objective methods like questionnaires and
self-reports. Because physical activity levels are not directly
observable, algorithms are used generate corresponding summary reports
of different activity level using complex data (e.g. steps, heart
rate).<br />
However, these results may differ depending on which device is used. And
aside from variation in hardware, data collected could also vary by the
combinations between how the device is worn and the activity of
interest. Although current devices may be sufficiently accurate to
monitor general physical activity levels, more precise data may enable
additional functions such as detecting irregular heart rhythms or
radiation exposures that would contribute toward improving the health of
the general public and elevating the overall well-being of society.</p>
<p>Quantile regression is a tool that was developed to meet the need for
modeling complex relationships between a set of covariates and quantiles
of an outcome. In obesity studies, the effects of interventions or
covariates on body mass index (BMI) are most commonly estimated using
ordinary least square methods. However, mean regression approaches are
unable to address these effects for individuals whose BMI values fall in
the upper quantile of the distribution. Compared with traditional linear
regression approaches, quantile regression approaches make no
assumptions regarding the distribution of residuals and are robust to
outlying observations.</p>
<!-- Thus, we would like to propose the linear quantile regression function with measurement error correction on functional data and demonstrate its usefulness in the National Health and Nutrition Examination Survey (NHANES) dataset with a focus on evaluating the association between physical activities and obesity.  -->
<p>Tekwe et. al.  proposed a simulation extrapolation (SIMEX) estimation
method that uses an instrumental variable to correct for bias due to
measurement error in scalar-on-function quantile linear regression. They
demonstrated the usefulness of this method by evaluating the association
between physical activity and obesity using the National Health and
Nutrition Examination Survey (NHANES) dataset <span class="citation">[8]</span>. Their statistical model is as follows:
<span class="math display">\[\begin{align*}
  &amp;Q_{Y_i|X_i,Z_i}(\tau) = \int_{\Omega} \beta(\tau,t) X_{i}(t) dt
+  (1,Z_i^T)\gamma(\tau)\\
  &amp;W_i(t) = X_i(t) + U_i(t)\\
  &amp;M_i(t) = \delta(t) X_i(t) + \eta_i(t)
\end{align*}\]</span> where the response variable <span class="math inline">\(Y_i\)</span> and scalar-valued covariates <span class="math inline">\(Z_i\)</span> are measured without error, the
function-valued covariate <span class="math inline">\(X_i(t)\)</span> is
measured with error as <span class="math inline">\(W_i(t)\)</span>, and
<span class="math inline">\(M_i(t)\)</span> is a measured instrumental
variable. The model also includes the following assumptions:</p>
<ol style="list-style-type: decimal">
<li><span class="math inline">\(Cov\{X_i(t),U_i(s)\} = 0\)</span>,</li>
<li><span class="math inline">\(Cov\{M_i(t),U_i(s)\} = 0\)</span>,</li>
<li><span class="math inline">\(E(W_{i}(t)|X_i(t)) =
X_i(t)\)</span></li>
<li><span class="math inline">\(U_i(t)\sim
GP\{\mathcal{0},\Sigma_{uu}\}\)</span>, <span class="math inline">\(GP\)</span> refers to Gaussian process.</li>
</ol>
<p>for <span class="math inline">\(\forall t,s\in[0,1]\)</span> and
<span class="math inline">\(i = 1,\dots,n\)</span>.</p>
<p>Their bias correction estimation method uses a two-stage strategy to
correct for measurement error in a function-valued covariate and then
fits a linear quantile regression model. In the first stage, an
instrumental variable is used to estimate the covariance matrix
associated with the measurement error. In the second stage, SIMEX is
used to correct for measurement error in the function-valued
covariate.</p>
<p>The <strong>MECfda</strong> package provides the function
<code>ME.fcQR_IV.SIMEX</code> for applying its bias-correction
estimation method in scalar-on-function quantile regression. The
arguments are described as follows:</p>
<ul>
<li><p><strong><code>data.Y</code> (Response Variable):</strong><br />
The response variable can be provided as an atomic vector, a one-column
matrix, or a data frame. A one-column data frame with a column name is
recommended for clarity.</p></li>
<li><p><strong><code>data.W</code> (Measurement Data):</strong><br />
This argument corresponds to <span class="math inline">\(W\)</span>, the
observed measurement of <span class="math inline">\(X\)</span> in the
statistical model. It should be provided as a data frame or matrix where
each row represents a subject and each column corresponds to a
measurement (time) point.</p></li>
<li><p><strong><code>data.Z</code> (Scalar Covariates):</strong><br />
The scalar covariate data can be omitted (or set to <code>NULL</code>)
if no scalar covariates are included in the model. Alternatively, it can
be provided as an atomic vector (for a single scalar covariate) or as a
matrix/data frame (for multiple scalar covariates). A data frame with
column names is recommended.</p></li>
<li><p><strong><code>data.M</code> (Instrumental
Variable):</strong><br />
This argument provides the data for <span class="math inline">\(M\)</span>, the instrumental variable. It should
be supplied as a data frame or matrix where each row represents a
subject and each column corresponds to a measurement (time)
point.</p></li>
<li><p><strong><code>tau</code> (Quantile Level):</strong><br />
Specifies the quantile level <span class="math inline">\(\tau \in
(0,1)\)</span> for the quantile regression model. The default is
0.5.</p></li>
<li><p><strong><code>t_interval</code> (Domain of the Function-Valued
Covariate):</strong><br />
A two-element vector defining the interval over which the
function-valued covariate is defined (default is <code>c(0,1)</code>,
representing the interval <span class="math inline">\([0,1]\)</span>).</p></li>
<li><p><strong><code>t_points</code> (Measurement Time
Points):</strong><br />
Specifies the sequence of time points at which measurements are taken.
The default is <code>NULL</code>.</p></li>
<li><p><strong><code>formula.Z</code> (Scalar Covariate
Formula):</strong><br />
This argument determines which components of <code>data.Z</code> are
included in the model and how the scalar covariates are treated (i.e.,
as fixed or random effects).</p></li>
<li><p><strong><code>basis.type</code>:</strong> Indicates the type of
basis function for the expansion. Options include
<code>&#39;Fourier&#39;</code>, <code>&#39;Bspline&#39;</code>, and <code>&#39;FPC&#39;</code>,
corresponding to the Fourier basis, b-spline basis, and functional
principal component basis, respectively.</p></li>
<li><p><strong><code>basis.order</code>:</strong> Specifies the number
of basis functions to use. For the Fourier basis (i.e., <span class="math inline">\(\frac{1}{2},\ \sin(kt),\ \cos(kt)\)</span> for
<span class="math inline">\(k = 1, \dots, p_f\)</span>),
<code>basis.order</code> equals <span class="math inline">\(p_f\)</span>. For the b-spline basis <span class="math inline">\(\{B_{i,p}(x)\}_{i=-p}^{k}\)</span>,
<code>basis.order</code> is set to <span class="math inline">\(k+p+1\)</span>. For the FPC basis,
<code>basis.order</code> represents the number of functional principal
components.</p></li>
<li><p><strong><code>bs_degree</code>:</strong> Specifies the degree of
the piecewise polynomials for the b-spline basis; this argument is only
necessary when using the b-spline basis.</p></li>
</ul>
<p>The function <code>ME.fcQR_IV.SIMEX</code> returns an object of class
<code>ME.fcQR_IV.SIMEX</code>, which is a list containing the following
elements:</p>
<ol style="list-style-type: decimal">
<li><strong><code>coef.X</code>:</strong> A <code>Fourier_series</code>
or <code>bspline_series</code> object representing the function-valued
coefficient parameter of the function-valued covariate.</li>
<li><strong><code>coef.Z</code>:</strong> The estimated linear
coefficients of the scalar covariates.</li>
<li><strong><code>coef.all</code>:</strong> The original estimate of the
linear coefficients.</li>
<li><strong><code>function.basis.type</code>:</strong> The type of
function basis used.</li>
<li><strong><code>basis.order</code>:</strong> The number of basis
functions used (as specified in the input).</li>
<li><strong><code>t_interval</code>:</strong> A two-element vector
representing the interval, which defines the domain of the
function-valued covariate.</li>
<li><strong><code>t_points</code>:</strong> The sequence of measurement
(time) points.</li>
<li><strong><code>formula</code>:</strong> The regression model.</li>
<li><strong><code>formula.Z</code>:</strong> A formula object containing
only the scalar covariates.</li>
<li><strong><code>zlevels</code>:</strong> The levels of any categorical
(non-continuous) scalar covariates.</li>
</ol>
<p>This comprehensive structure ensures that users can flexibly input
their data and clearly specify the modeling framework for
bias-correction in scalar-on-function quantile regression.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a><span class="fu">data</span>(MECfda.data.sim.<span class="fl">0.2</span>)</span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a>res <span class="ot">=</span> <span class="fu">ME.fcQR_IV.SIMEX</span>(<span class="at">data.Y =</span> MECfda.data.sim.<span class="fl">0.2</span><span class="sc">$</span>Y,</span>
<span id="cb20-4"><a href="#cb20-4" tabindex="-1"></a>                       <span class="at">data.W =</span> MECfda.data.sim.<span class="fl">0.2</span><span class="sc">$</span>W,</span>
<span id="cb20-5"><a href="#cb20-5" tabindex="-1"></a>                       <span class="at">data.Z =</span> MECfda.data.sim.<span class="fl">0.2</span><span class="sc">$</span>Z,</span>
<span id="cb20-6"><a href="#cb20-6" tabindex="-1"></a>                       <span class="at">data.M =</span> MECfda.data.sim.<span class="fl">0.2</span><span class="sc">$</span>M,</span>
<span id="cb20-7"><a href="#cb20-7" tabindex="-1"></a>                       <span class="at">tau =</span> <span class="fl">0.5</span>,</span>
<span id="cb20-8"><a href="#cb20-8" tabindex="-1"></a>                       <span class="at">basis.type =</span> <span class="st">&#39;Bspline&#39;</span>)</span></code></pre></div>
</div>
<div id="me.fcqr_cls" class="section level3">
<h3>ME.fcQR_CLS</h3>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a><span class="fu">ME.fcQR_CLS</span>(</span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a>  data.Y,</span>
<span id="cb21-3"><a href="#cb21-3" tabindex="-1"></a>  data.W,</span>
<span id="cb21-4"><a href="#cb21-4" tabindex="-1"></a>  data.Z,</span>
<span id="cb21-5"><a href="#cb21-5" tabindex="-1"></a>  <span class="at">tau =</span> <span class="fl">0.5</span>,</span>
<span id="cb21-6"><a href="#cb21-6" tabindex="-1"></a>  <span class="at">t_interval =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb21-7"><a href="#cb21-7" tabindex="-1"></a>  <span class="at">t_points =</span> <span class="cn">NULL</span>,</span>
<span id="cb21-8"><a href="#cb21-8" tabindex="-1"></a>  grid_k,</span>
<span id="cb21-9"><a href="#cb21-9" tabindex="-1"></a>  grid_h,</span>
<span id="cb21-10"><a href="#cb21-10" tabindex="-1"></a>  <span class="at">degree =</span> <span class="dv">45</span>,</span>
<span id="cb21-11"><a href="#cb21-11" tabindex="-1"></a>  <span class="at">observed_X =</span> <span class="cn">NULL</span></span>
<span id="cb21-12"><a href="#cb21-12" tabindex="-1"></a>)</span></code></pre></div>
<p>Zhang et. al.  proposed a corrected loss score estimation method for
scalar-on-function quantile linear regression to correct for bias due to
measurement error <span class="citation">[9]</span>. Their statistical
model is as follows: <span class="math display">\[\begin{align*}
  &amp;Q_{Y_i|X_i,Z_i}(\tau) = \int_{\Omega} \beta(\tau,t) X_{i}(t) dt
+  (1,Z_i^T)\gamma(\tau)\\
  &amp;W_i(t) = X_i(t) + U_i(t)
\end{align*}\]</span> where the response variable <span class="math inline">\(Y_i\)</span> and the scalar-valued covariates
<span class="math inline">\(Z_i\)</span> are measured without error, the
function-valued covariate <span class="math inline">\(X_i(t)\)</span> is
measured with error as <span class="math inline">\(W_i(t)\)</span>.</p>
<ol style="list-style-type: decimal">
<li><span class="math inline">\(E[U_i(t)]=0\)</span>.</li>
<li><span class="math inline">\(Cov\{U_i(t),U_i(s)\} =
\Sigma_U(s,t)\)</span>, where <span class="math inline">\(\Sigma_U(s,t)\)</span> is unknown.</li>
<li><span class="math inline">\(U_i(t)\)</span> are i.i.d for different
<span class="math inline">\(i\)</span>.</li>
</ol>
<p>Zhang et al. proposed a new corrected loss function for a partially
functional linear quantile model with functional measurement error in
this manuscript. They established a corrected quantile objective
function for an observed measurement, which is an unbiased estimator of
the quantile objective function that would be obtained if the true
measurements were available. The estimators of the regression parameters
are obtained by optimizing the resulting corrected loss function. The
resulting estimator of the regression parameters is shown to be
consistent.</p>
<p>The <strong>MECfda</strong> package provides a function,
<code>ME.fcQR_CLS</code>, for implementing their bias-correction
estimation method. Below is a description of its arguments and return
values:</p>
<ul>
<li><p><strong><code>data.Y</code> (Response Variable):</strong><br />
The response variable can be provided as an atomic vector, a one-column
matrix, or a data frame. The recommended format is a one-column data
frame with a column name.</p></li>
<li><p><strong><code>data.W</code> (Measurement Data for <span class="math inline">\(W\)</span>):</strong><br />
This argument represents <span class="math inline">\(W\)</span>, the
observed measurement of <span class="math inline">\(X\)</span> in the
statistical model. It should be provided as a three-dimensional array
where each row corresponds to a subject, each column to a measurement
(time) point, and each layer to an observation.</p></li>
<li><p><strong><code>data.Z</code> (Scalar Covariates):</strong><br />
Scalar covariates can be omitted (or set to <code>NULL</code>) if no
scalar covariates are included in the model, provided as an atomic
vector for a single scalar covariate, or as a matrix or data frame for
multiple covariates. The recommended format is a data frame with column
names.</p></li>
<li><p><strong><code>tau</code> (Quantile Level):</strong><br />
Specifies the quantile <span class="math inline">\(\tau \in
(0,1)\)</span> to be used in the quantile regression model. The default
value is 0.5.</p></li>
<li><p><strong><code>t_interval</code> (Domain of the Function-Valued
Covariate):</strong><br />
A two-element vector that specifies the domain (interval) of the
function-valued covariate. The default is <code>c(0,1)</code>,
representing the interval <span class="math inline">\([0,1]\)</span>.</p></li>
<li><p><strong><code>t_points</code> (Measurement Time
Points):</strong><br />
Specifies the sequence of measurement (time) points. The default is
<code>NULL</code>.</p></li>
<li><p><strong><code>grid_k</code> (Candidate Basis
Numbers):</strong><br />
An atomic vector where each element is a candidate number for the basis
functions.</p></li>
<li><p><strong><code>grid_h</code> (Candidate Tuning Parameter
Values):</strong><br />
A non-zero atomic vector where each element is a candidate value for the
tuning parameter.</p></li>
<li><p><strong><code>degree</code> (Degree for Derivative and Integral
Calculations):</strong><br />
This argument is used when computing derivatives and integrals, with a
default value of 45—which is sufficient for most scenarios.</p></li>
<li><p><strong><code>observed_X</code> (Observed <span class="math inline">\(X\)</span> Data for Variance
Estimation):</strong><br />
Used for estimating parametric variance; the default value is
<code>NULL</code>.</p></li>
</ul>
<p>The function returns an object of class <code>ME.fcQR_CLS</code> (a
list) containing the following elements:</p>
<ol style="list-style-type: decimal">
<li><strong><code>estimated_beta_hat</code>:</strong> Estimated
coefficients from the corrected loss function (including the functional
component).</li>
<li><strong><code>estimated_beta_t</code>:</strong> The estimated
functional curve.</li>
<li><strong><code>SE_est</code>:</strong> The estimated parametric
variance (returned only if <code>observed_X</code> is not
<code>NULL</code>).</li>
<li><strong><code>estimated_Xbasis</code>:</strong> The basis matrix
used in the estimation.</li>
<li><strong><code>res_naive</code>:</strong> Results from the naive
(uncorrected) method.</li>
</ol>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a><span class="fu">data</span>(MECfda.data.sim.<span class="fl">0.1</span>)</span>
<span id="cb22-3"><a href="#cb22-3" tabindex="-1"></a>res <span class="ot">=</span> <span class="fu">ME.fcQR_CLS</span>(<span class="at">data.Y =</span> MECfda.data.sim.<span class="fl">0.1</span><span class="sc">$</span>Y,</span>
<span id="cb22-4"><a href="#cb22-4" tabindex="-1"></a>                  <span class="at">data.W =</span> MECfda.data.sim.<span class="fl">0.1</span><span class="sc">$</span>W,</span>
<span id="cb22-5"><a href="#cb22-5" tabindex="-1"></a>                  <span class="at">data.Z =</span> MECfda.data.sim.<span class="fl">0.1</span><span class="sc">$</span>Z,</span>
<span id="cb22-6"><a href="#cb22-6" tabindex="-1"></a>                  <span class="at">tau =</span> <span class="fl">0.5</span>,</span>
<span id="cb22-7"><a href="#cb22-7" tabindex="-1"></a>                  <span class="at">grid_k =</span> <span class="dv">4</span><span class="sc">:</span><span class="dv">7</span>,</span>
<span id="cb22-8"><a href="#cb22-8" tabindex="-1"></a>                  <span class="at">grid_h =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>)</span></code></pre></div>
</div>
<div id="me.fclr_iv" class="section level3">
<h3>ME.fcLR_IV</h3>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a><span class="fu">ME.fcLR_IV</span>(</span>
<span id="cb23-2"><a href="#cb23-2" tabindex="-1"></a>  data.Y,</span>
<span id="cb23-3"><a href="#cb23-3" tabindex="-1"></a>  data.W,</span>
<span id="cb23-4"><a href="#cb23-4" tabindex="-1"></a>  data.M,</span>
<span id="cb23-5"><a href="#cb23-5" tabindex="-1"></a>  <span class="at">t_interval =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb23-6"><a href="#cb23-6" tabindex="-1"></a>  <span class="at">t_points =</span> <span class="cn">NULL</span>,</span>
<span id="cb23-7"><a href="#cb23-7" tabindex="-1"></a>  <span class="at">CI.bootstrap =</span> F</span>
<span id="cb23-8"><a href="#cb23-8" tabindex="-1"></a>)</span></code></pre></div>
<p>Tekwe et. al.  proposed a bias correction estimation method for
scalar-on-function linear regression model with measurement error using
an instrumental variable <span class="citation">[6]</span>. Their
statistical model is as follows: <span class="math display">\[\begin{align*}
  &amp;Y_i = \int_0^1 \beta(t)X_i(t)dt + \varepsilon_i\\
  &amp;W_i(t) = X_i(t) + U_i(t)\\
  &amp;M_i(t) = \delta X_i(t) + \eta_i(t)
\end{align*}\]</span> where the response variable <span class="math inline">\(Y_i\)</span> and are measured without error, the
function-valued covariate <span class="math inline">\(X_i(t)\)</span> is
measured with error as <span class="math inline">\(W_i(t)\)</span>, and
<span class="math inline">\(M_i(t)\)</span> is an measured instrumental
variable. They included the following additional assumptions:</p>
<ol style="list-style-type: decimal">
<li><span class="math inline">\(E\varepsilon_i(t) = 0\)</span>,</li>
<li><span class="math inline">\(EU_i(t) = 0\)</span>,</li>
<li><span class="math inline">\(E\eta_i(t) = 0\)</span>,</li>
<li><span class="math inline">\(Cov\{X_i(t),\varepsilon_i\} =
0\)</span>,</li>
<li><span class="math inline">\(Cov\{M_i(t),\varepsilon_i\} =
0\)</span>,</li>
<li><span class="math inline">\(Cov\{M_i(t),U_i(s)\} = 0\)</span>,</li>
</ol>
<p>for <span class="math inline">\(\forall t,s\in[0,1]\)</span> and
<span class="math inline">\(i = 1,\dots,n\)</span>.</p>
<p>The <strong>MECfda</strong> package provides the function
<code>ME.fcLR_IV</code> for implementing their bias-correction
estimation method. The arguments are as follows:</p>
<ul>
<li><p><strong><code>data.Y</code> (Response Variable):</strong><br />
The response variable can be provided as an atomic vector, a one-column
matrix, or a data frame. The recommended format is a one-column data
frame with a column name.</p></li>
<li><p><strong><code>data.W</code> (Measurement Data for <span class="math inline">\(W\)</span>):</strong><br />
This argument represents <span class="math inline">\(W\)</span>, the
observed measurement of <span class="math inline">\(X\)</span> in the
statistical model. It should be provided as a data frame or matrix,
where each row represents a subject and each column corresponds to a
measurement (time) point.</p></li>
<li><p><strong><code>data.M</code> (Instrumental
Variable):</strong><br />
This argument provides the data for <span class="math inline">\(M\)</span>, the instrumental variable. It should
be provided as a data frame or matrix, with each row representing a
subject and each column representing a measurement (time)
point.</p></li>
<li><p><strong><code>t_interval</code> (Domain of the Function-Valued
Covariate):</strong><br />
A two-element vector that specifies the domain (interval) of the
function-valued covariate. The default is <code>c(0,1)</code>,
representing the interval <span class="math inline">\([0,1]\)</span>.</p></li>
<li><p><strong><code>t_points</code> (Measurement Time
Points):</strong><br />
Specifies the sequence of measurement (time) points. The default is
<code>NULL</code>.</p></li>
<li><p><strong><code>CI.bootstrap</code> (Bootstrap Confidence
Interval):</strong><br />
A logical flag indicating whether to return a confidence interval using
the bootstrap method. The default is <code>FALSE</code>.</p></li>
</ul>
<p>The function returns an object of class <code>ME.fcLR_IV</code>,
which is a list containing the following elements:</p>
<ol style="list-style-type: decimal">
<li><strong><code>beta_tW</code>:</strong> Parameter estimates.</li>
<li><strong><code>CI</code>:</strong> Confidence interval, which is
returned only if <code>CI.bootstrap</code> is <code>TRUE</code>.</li>
</ol>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb24-2"><a href="#cb24-2" tabindex="-1"></a><span class="fu">data</span>(MECfda.data.sim.<span class="fl">0.3</span>)</span>
<span id="cb24-3"><a href="#cb24-3" tabindex="-1"></a>res <span class="ot">=</span> <span class="fu">ME.fcLR_IV</span>(<span class="at">data.Y =</span> MECfda.data.sim.<span class="fl">0.3</span><span class="sc">$</span>Y,</span>
<span id="cb24-4"><a href="#cb24-4" tabindex="-1"></a>                 <span class="at">data.W =</span> MECfda.data.sim.<span class="fl">0.3</span><span class="sc">$</span>W,</span>
<span id="cb24-5"><a href="#cb24-5" tabindex="-1"></a>                 <span class="at">data.M =</span> MECfda.data.sim.<span class="fl">0.3</span><span class="sc">$</span>M)</span></code></pre></div>
</div>
</div>
<div id="simulated-data-generation" class="section level1">
<h1>Simulated Data Generation</h1>
<p>The package <strong>MECfda</strong> includes some functions to
generate simulated data to test the functions in the package.</p>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="unnumbered">References</h1>
<div id="refs" class="references csl-bib-body">
<div id="ref-wang2016functional" class="csl-entry">
1. Wang J-L, Chiou J-M, Müller H-G. Functional data analysis. Annual
Review of Statistics and its application. 2016;3:257–95.
</div>
<div id="ref-ramsay2002applied" class="csl-entry">
2. Ramsay JO, Silverman BW. Applied functional data analysis: Methods
and case studies. Springer; 2002.
</div>
<div id="ref-ramsay1991some" class="csl-entry">
3. Ramsay JO, Dalzell C. Some tools for functional data analysis.
Journal of the Royal Statistical Society Series B: Statistical
Methodology. 1991;53:539–61.
</div>
<div id="ref-carroll2006measurement" class="csl-entry">
4. Carroll RJ, Ruppert D, Stefanski LA, Crainiceanu CM. Measurement
error in nonlinear models: A modern perspective. Chapman; Hall/CRC;
2006.
</div>
<div id="ref-crainiceanu2009generalized" class="csl-entry">
5. Crainiceanu CM, Staicu A-M, Di C-Z. Generalized multilevel functional
regression. Journal of the American Statistical Association.
2009;104:1550–61.
</div>
<div id="ref-tekwe2019instrumental" class="csl-entry">
6. Tekwe CD, Zoh RS, Yang M, Carroll RJ, Honvoh G, Allison DB, et al.
Instrumental variable approach to estimating the scalar-on-function
regression model with measurement error with application to energy
expenditure assessment in childhood obesity. Statistics in medicine.
2019;38:3764–81.
</div>
<div id="ref-luan2023scalable" class="csl-entry">
7. Luan Y, Zoh RS, Cui E, Lan X, Jadhav S, Tekwe CD. Scalable regression
calibration approaches to correcting measurement error in multi-level
generalized functional linear regression models with heteroscedastic
measurement errors. arXiv preprint arXiv:230512624. 2023.
</div>
<div id="ref-tekwe2022estimation" class="csl-entry">
8. Tekwe CD, Zhang M, Carroll RJ, Luan Y, Xue L, Zoh RS, et al.
Estimation of sparse functional quantile regression with measurement
error: A SIMEX approach. Biostatistics. 2022;23:1218–41.
</div>
<div id="ref-zhang2023partially" class="csl-entry">
9. Zhang M, Xue L, Tekwe CD, Bai Y, Qu A. Partially functional linear
quantile regression model with measurement errors. Statistica Sinica.
2023;33:2257–80.
</div>
<div id="ref-R-base" class="csl-entry">
10. R Core Team. <a href="https://www.R-project.org/">R: A language and
environment for statistical computing</a>. Vienna, Austria: R Foundation
for Statistical Computing; 2017.
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
